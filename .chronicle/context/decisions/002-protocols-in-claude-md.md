# ADR-002: Protocols in CLAUDE.md

**Date:** 2025-02-01
**Status:** Accepted
**Context:** Chronicle system initialization

## Context and Problem

Chronicle needs to provide complete operating instructions for Claude to maintain the documentation system. Where should these ~200 lines of protocols live?

The skill bootstraps the project and then exits - it can't be relied upon for ongoing operation.

## Decision

Write complete chronicle protocols directly into CLAUDE.md during initialization, wrapped in HTML comment region markers.

## Alternatives Considered

**Option A: Separate .chronicle/protocols.md file with indirection**
- Pro: Keeps CLAUDE.md shorter and cleaner
- Pro: Clear separation between project-specific and system protocols
- **Con: Unreliable** - Requires Claude to remember to read protocols.md
- **Con: Extra tool call** - CLAUDE.md is automatic, separate file requires conscious view
- **Con: Inconsistent behavior** - Claude might forget to check it in some sessions
- **Why rejected:** Indirection creates failure points

**Option B: Keep protocols in active skill**
- Pro: Skill can update protocols across all projects
- **Con: Projects break if skill unavailable** - violates self-containment principle
- **Con: Dependency on skill** - defeats bootstrap-and-exit pattern
- **Why rejected:** Contradicts core regenerative principle

**Option C: Hybrid (essentials in CLAUDE.md, details in protocols.md)**
- Pro: Balance between brevity and completeness
- **Con: Which protocols are "essential"?** - Hard to draw the line
- **Con: Still has reliability issues** - Claude might not read details file when needed
- **Why rejected:** Doesn't solve fundamental indirection problem

## Consequences

**Positive:**
- ✅ Reliable - CLAUDE.md is always loaded automatically
- ✅ Self-contained - Project works forever without skill
- ✅ Consistent - Same behavior every session
- ✅ Transparent - All protocols visible and editable
- ✅ No tool calls needed - Zero overhead

**Negative:**
- ❌ CLAUDE.md gets ~200 lines longer
- ❌ Might feel overwhelming at first glance
- ❌ Protocols not centrally updateable across projects

## Implementation Notes

**Region markers:**
```markdown
<!-- ============================================================ -->
<!-- CHRONICLE SYSTEM PROTOCOLS                                   -->
<!-- Generated by: chronicle skill v1.0.0                         -->
<!-- Initialized: [DATE]                                          -->
<!-- ============================================================ -->

[200+ lines of protocols]

<!-- ============================================================ -->
<!-- END CHRONICLE SYSTEM PROTOCOLS                               -->
<!-- ============================================================ -->
```

**Update mechanism:**
Optional skill command "update chronicle protocols" can refresh the region while preserving user customizations outside markers.

**Precedent:**
Complex projects commonly have 300-500 line CLAUDE.md files. 200 lines of chronicle protocols is well within normal range.

## Related Decisions

- DEC-001: Bootstrap-and-exit pattern (requires protocols to be self-contained)
- DEC-003: 10-file structure (protocols not in file count, they're in CLAUDE.md)
