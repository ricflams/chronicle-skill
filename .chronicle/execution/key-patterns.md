# Key Patterns

*Recurring techniques and approaches used in chronicle design and implementation*

---

## Design Patterns

### Bootstrap-and-Exit
**Pattern:** Skill initializes system, transfers knowledge to project, then becomes unnecessary

**Where used:** Chronicle skill initialization

**Why chosen:** Creates self-contained projects that work forever, even without skill

**Implementation:**
1. Skill runs comprehensive initialization
2. Writes complete protocols to CLAUDE.md
3. Creates all file structure
4. Exits - no longer needed

**Alternatives considered:** Keep skill active (rejected - creates dependency)

---

### HTML Comment Regions
**Pattern:** Use HTML comments to mark skill-generated vs user-customized content

**Where used:** CLAUDE.md protocol insertion

**Why chosen:** Clear boundaries, updatable without clobbering user content

**Implementation:**
```markdown
<!-- ============================================================ -->
<!-- CHRONICLE SYSTEM PROTOCOLS                                   -->
<!-- Generated by: chronicle skill v1.0.0                         -->
<!-- Initialized: [DATE]                                          -->
<!-- ============================================================ -->

[Skill-generated content]

<!-- ============================================================ -->
<!-- END CHRONICLE SYSTEM PROTOCOLS                               -->
<!-- ============================================================ -->
```

**Benefits:** 
- Visual separation
- Update mechanism can find and replace region
- User customizations outside markers preserved

---

### Adaptive Terminology
**Pattern:** Use universal terms, auto-detect project type and adapt language

**Where used:** File names, template content, questioning

**Why chosen:** Lower friction than asking "is this software/DIY/creative?"

**Implementation:**

| Universal Term | Software | DIY | Presentation |
|----------------|----------|-----|--------------|
| Parts | Components | Materials | Slides |
| Validation | Testing | Inspection | Rehearsal |
| Problems | Bugs | Issues | Roadblocks |

**Triggers:** Check for *.cs, *.js, package.json, src/ to detect software

---

### Progress Bar Visualization
**Pattern:** Show question completeness with visual progress bars

**Where used:** Phase 2 of initialization (depth visualization)

**Why chosen:** Helps users decide where to dig deeper without analysis paralysis

**Implementation:**
```
üìä Project Context Completeness
Objectives          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë  80%  Good depth
Constraints         ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  30%  Needs exploration
Non-goals           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100%  Clear
```

**Benefits:**
- Quick visual scan of completeness
- Directs attention to gaps
- Reduces decision fatigue

---

### Jobs-to-be-Done Framing
**Pattern:** Ask "what job is this project hired to do?" instead of "what are the requirements?"

**Where used:** Phase 1 initialization questions

**Why chosen:** Elicits better context about purpose than traditional requirement questions

**Implementation:**
- Question 2: "Why does it exist? What job is it hired to do?"
- Focuses on outcome, not features
- Reveals true user needs

---

### Context Exclusion as Feature
**Pattern:** Deliberately exclude certain files from AI context as design decision

**Where used:** completed-tasks.md, USING-CHRONICLE.md

**Why chosen:** 
- completed-tasks.md: Human progress tracking, session-log.md has AI-relevant details
- USING-CHRONICLE.md: User guide, not AI instructions

**Implementation:**
```markdown
### Context Management Rules

**NEVER Load into Context:**
- .chronicle/journey/completed-tasks.md (human reference only)
- USING-CHRONICLE.md (user guide only)
```

**Benefits:**
- Prevents context pollution
- Maintains clear purpose for each file
- Optimizes AI context usage

---

## Workflow Patterns

### Proactive Task Detection
**Pattern:** Watch for planning conversations and offer to capture tasks

**Where used:** Task management

**Why chosen:** Reduces friction - user doesn't have to explicitly "add task"

**Triggers:**
- "I need to..."
- "We should..."
- "Let's implement..."
- Multiple action items in sequence

**Implementation:**
```
User: "For the circuit breaker, I need to implement state machine,
       add tests, and hook up metrics"

Claude: "I noticed we identified some tasks:
         1. Implement state machine
         2. Add tests
         3. Hook up metrics
         
         Should I add these to active-tasks.md?"
```

---

### Automatic Task Completion Workflow
**Pattern:** Multi-step workflow triggered by single command

**Where used:** "Mark task complete: X"

**Why chosen:** Reduces manual tracking burden, ensures consistency

**Steps:**
1. Check off in active-tasks.md
2. Move to completed-tasks.md with metadata
3. Add entry to session-log.md
4. Suggest next task

**All automatic** - user just says "mark complete"

---

### Weekly Compression
**Pattern:** Periodically compress session logs into project-truth.md

**Where used:** Session end protocol step 7

**Why chosen:** Keeps project-truth.md current without it becoming stale

**Trigger:** >7 days since last update

**Process:**
- Review recent session logs
- Extract key themes and patterns
- Update project-truth.md sections
- Refresh "Evolution of Design" narrative

---

### Quick vs Deep Entry Modes
**Pattern:** Support both lightweight and comprehensive documentation

**Where used:** Problems logging, decision recording

**Why chosen:** Balance between low friction and thorough documentation

**Quick mode (default):**
```
User: "Log problem: CORS blocked, fixed with proxy"
‚Üí Brief entry in lessons.md
```

**Deep mode (triggered):**
```
User: "Document this problem comprehensively"
‚Üí Follow-up questions
‚Üí Rich entry with full context
```

---

## Communication Patterns

### Catchy Items First, Details After
**Pattern:** Lead with memorable one-liners, follow with explanations

**Where used:** USING-CHRONICLE.md purpose section

**Why chosen:** Easier to grasp and remember

**Implementation:**
```markdown
**üìã Task Organization** ‚Äî Never ask "what's next?"
**üó∫Ô∏è Journey Documentation** ‚Äî Capture why, not just what
**ü§ñ AI Context Preservation** ‚Äî Enable seamless collaboration

[Then expand each with bullet points]
```

---

### Before/After Examples
**Pattern:** Show contrast between with/without chronicle

**Where used:** User guide "Three Purposes in Action"

**Why chosen:** Makes value proposition concrete and tangible

**Implementation:**
```
Without chronicle:
[Pain point scenario]

With chronicle:
[Solution scenario]
```

---

## File Organization Patterns

### Layered Directory Structure
**Pattern:** Organize by conceptual layer, not file type

**Layers:**
- Truth layer: project-truth.md, active-tasks.md (what/why/next)
- Context layer: structure, decisions
- Journey layer: history, learnings
- Execution layer: how we work

**Why chosen:** Matches mental model of how you navigate project understanding

---

### Flat Archive with Timestamp
**Pattern:** completed-tasks.md uses simple flat list with dates, no subdirectories

**Why chosen:** 
- Easy to search
- Simple to maintain
- No directory management overhead

**Format:**
```markdown
## 2025-02
- [x] Task name (Completed: 2025-02-01, Duration: 3h)
```

---

## Testing Patterns

### Regeneration Test
**Pattern:** Can someone recreate functionally equivalent work from chronicle alone?

**Where used:** Validation of chronicle completeness

**Test:** New team member reads .chronicle/, can they contribute meaningfully in 45min?

**If no:** Add more context to chronicle
