<!-- ============================================================ -->
<!-- CHRONICLE SYSTEM PROTOCOLS                                   -->
<!-- Generated by: chronicle skill v1.0.0                         -->
<!-- Initialized: [DATE]                                          -->
<!-- ============================================================ -->

## Chronicle System

This project maintains a chronicle in `.chronicle/` where documentation
is the source of truth.

### Planning Mode → Task List Workflow

**When in Planning Mode:**
Planning mode creates plans but does NOT implement or edit files.

**Workflow:**
1. User and Claude collaborate on task plan in planning mode
2. When plan is finalized, Claude says: **"Ready to implement? Switch to agent mode and say 'add the task'"**
3. **User manually switches to agent mode** (Claude cannot do this)
4. User signals task creation with phrases like:
   - "Add the task"
   - "Create the task"
   - "Task accepted"
   - Or any clear indication to proceed

**When user says "add the task" (in agent mode):**
1. Create task file in `.chronicle/tasks/NNNN-task-name.md` based on the plan
2. Confirm task created
3. Ask: "Should I start working on this task now?"
4. Wait for user response:
   - "Yes" / "Start" → Begin implementation
   - "No" / "Just queue it" → Stop, task queued for later

**Starting work later:**
User says "Start working on [task name]" → Begin implementation

### Current Work

Check `.chronicle/tasks/` folder for what to work on next. Use "list tasks" command for overview.

### Before Starting Work

**Two-tier context loading:**

1. **Load essential context first** (~5K tokens):
   - `.chronicle/project-truth.md` - Complete project context
   - `.chronicle/tasks/*` - All active task files
   - `.chronicle/context/principles.md` - Quick decisions
   - `.chronicle/journey/lessons.md` - Accumulated wisdom
   - `.chronicle/execution/key-facts.md` - Configuration & references

2. **Load on-demand context** when needed:
   - `.chronicle/journey/session-log.md` - Recent developments (last 2-3 sessions)
   - `.chronicle/context/decisions/*` - Full ADRs for deep architectural questions
   - `.chronicle/context/visuals/*` - Diagrams when architecture review needed
   - `.chronicle/execution/parts-manifest.md` - Component details
   - `.chronicle/execution/key-patterns.md` - Technique reference
   - `.chronicle/execution/validation-strategy.md` - Testing criteria

3. **Check current work:**
   - "List tasks" or "Show tasks" to see active work
   - "What should I work on?" for priority suggestions

**Session log compression:**
When `.chronicle/journey/session-log.md` exceeds 300 lines:
1. Move oldest sessions to `.chronicle/journey/session-archive.md`
2. Extract major learnings to `.chronicle/journey/lessons.md`
3. Keep only last 2-3 sessions in session-log.md

### Task Management

**List all tasks:**
When user says "List tasks" / "Show tasks" / "What are the tasks?":
1. Scan `.chronicle/tasks/` directory
2. Read each task file to get title and creator
3. Display numbered list with format: `0001: Task name (created by X on DATE)`

**What should I work on?**
→ List tasks, suggest highest priority or ask user to pick

**Create new task:**
When planning mode produces task or user requests:
1. Find highest number in `.chronicle/tasks/` directory
2. Increment by 1 (e.g., 0011 → 0012)
3. Create `.chronicle/tasks/NNNN-task-name.md` with format:
   ```markdown
   # Task: [Task Name]
   
   **Created:** YYYY-MM-DD by [User Name]
   
   ## Description
   
   [Task details and plan]
   ```
4. Confirm creation

**When task completed:**
1. User says "[task] is complete" or "mark [task] complete"
2. Move task file from `.chronicle/tasks/NNNN-name.md` → `.chronicle/journey/completed-tasks/NNNN-name.md`
3. Update file with completion info (add "**Completed:** YYYY-MM-DD (Duration: Xh)" after Created line)
4. Add entry to `.chronicle/journey/session-log.md`
5. Suggest next task from remaining tasks

**When problem encountered:**
→ Log in `.chronicle/journey/lessons.md`

**When significant decision made:**
→ Create ADR in `.chronicle/context/decisions/`

### Session End

When user says "update chronicle":
1. Summarize session (key accomplishments, decisions, learnings)
2. Update `.chronicle/journey/session-log.md` with detailed narrative
3. Ensure completed tasks moved to `.chronicle/journey/completed-tasks/` (check if any missed)
4. Create ADRs in `.chronicle/context/decisions/` if significant decisions made
5. Update diagrams in `.chronicle/context/visuals/` if structure changed
6. Document problems/learnings in `.chronicle/journey/lessons.md`
7. Weekly check: If >7 days of logs, suggest compressing into `.chronicle/project-truth.md`
8. Update check: Ensure protocols stay current with skill evolution

### Context Management

**Always in context:**
- .chronicle/project-truth.md
- .chronicle/tasks/* (all active task files)
- .chronicle/context/*
- .chronicle/journey/session-log.md
- .chronicle/journey/lessons.md
- .chronicle/execution/*

**Never in context:**
- .chronicle/journey/completed-tasks/* (human reference only)

### Regeneration Principle

From `.chronicle/` alone, work should be recreatable by anyone (human or AI). Documentation is the source of truth - code can be regenerated; understanding cannot.

<!-- ============================================================ -->
<!-- END CHRONICLE SYSTEM PROTOCOLS                               -->
<!-- ============================================================ -->

